{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export function createGalleryMarkup(array) {\n    return array\n        .map(({\n            webformatURL,\n            largeImageURL,\n            tags,\n            likes,\n            views,\n            comments,\n            downloads,\n        }) => `\n    <li class=\"gallery-card\">\n        <a class=\"card-link\" href=\"${largeImageURL}\">\n            <img class=\"image\" src=\"${webformatURL}\" alt=\"${tags}\"></a>\n        <ul class=\"card-description\">\n            <li><p class=\"name\">Likes</p>\n            <p class=\"value\">${likes}</p></liss=>\n            <li><p class=\"name\">Views</p>\n            <p class=\"value\">${views}</p></li>\n            <li><p class=\"name\">Comments</p>\n            <p class=\"value\">${comments}</p></li>\n            <li><p class=\"name\">Downloads</p>\n            <p class=\"value\">${downloads}</p></li>\n        </ul>\n    </li>\n    `)\n        .join('');\n}\n","import axios from 'axios';\n\nexport function fetchRequest(name) {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const API_KEY = '43226276-a07a0c17e428cfffb021b9b05';\n\n    const params = new URLSearchParams({\n        key: API_KEY,\n        q: name,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n    });\n\n    return axios.get(`${BASE_URL}?${params.toString()}`)\n        .then(response => {\n            if (!response.data) {\n                throw new Error(response.status);\n            }\n            return response.data;\n        })\n        .catch(error => {\n            throw new Error('Request failed with status:' + error.response.status);\n        });\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { createGalleryMarkup } from './js/render-functions';\nimport { fetchRequest } from './js/pixabay-api';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.input');\nconst loader = document.querySelector('.loader');\nloader.style.display = 'none';\nconst gallery = document.querySelector('.gallery');\nconst loadButton = document.querySelector('.load-button');\nloadButton.style.display = 'none';\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n});\nconst perPage = 15;\nlet currentPage = 1;\n\nform.addEventListener('submit', handleSubmit);\nloadButton.addEventListener('click', loadNextPage);\n\n// function handleSubmit(event) {\n//     event.preventDefault();\n//     gallery.innerHTML = '';\n//     loader.style.display = 'block';\n//     const inputValue = event.currentTarget.elements.input.value.trim();\n\n//     fetchRequest(inputValue)\n//         .then(data => {\n//             loader.style.display = 'none';\n\n//             if (!data.hits.length) {\n//                 iziToast.error({\n//                     message:\n//                         'Sorry, there are no images matching your search query. Please, try again!',\n//                     messageColor: '#fafafb',\n//                     messageSize: '16px',\n//                     messageLineHeight: '1.5',\n//                     backgroundColor: '#ef4040',\n//                     position: 'topRight',\n//                 });\n//             }\n\n//             return data;\n//         })\n\n//         .then(data => {\n//             gallery.innerHTML = createGalleryMarkup(data.hits);\n//             loadButton.style.display = 'block';\n//             lightbox.refresh();\n//             form.reset();\n//         })\n\n//         .catch(error => {\n//             loader.style.display = 'none';\n//             iziToast.error({\n//                 message:\n//                     'Sorry, there are no images matching your search query. Please, try again!',\n//                 messageColor: '#fafafb',\n//                 messageSize: '16px',\n//                 messageLineHeight: '1.5',\n//                 backgroundColor: '#ef4040',\n//                 position: 'topRight',\n//             });\n//         });\n// }\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n    loader.style.display = 'block';\n    gallery.innerHTML = '';\n    const inputValue = input.value.trim();\n    if (inputValue === '') {\n        loader.style.display = 'none';\n        loadButton.style.display = 'none';\n        form.reset();\n        lightbox.refresh();\n        iziToast.info({\n            message: 'Looks like you forgot to fill in the search query...',\n            messageColor: '#fafafb',\n            messageSize: '16px',\n            messageLineHeight: '1.5',\n            position: 'topRight',\n        });\n        return;\n    }\n\n    try {\n        const data = await fetchRequest(inputValue, currentPage);\n        const totalPages = Math.ceil(data.totalHits / perPage);\n        loader.style.display = 'none';\n        if (totalPages === 0) {\n            loadButton.style.display = 'none';\n            lightbox.refresh();\n            form.reset();\n            iziToast.error({\n                message:\n                    'Sorry, there are no images matching your search query. Please, try again!',\n                messageColor: '#fafafb',\n                messageSize: '16px',\n                messageLineHeight: '1.5',\n                backgroundColor: '#ef4040',\n                position: 'topRight',\n            });\n        } else if (totalPages === 1) {\n            loadButton.style.display = 'none';\n            gallery.innerHTML = createGalleryMarkup(data.hits);\n            lightbox.refresh();\n            form.reset();\n        } else if (totalPages > 1) {\n            loadButton.style.display = 'block';\n            gallery.insertAdjacentHTML('beforeend', createGalleryMarkup(data.hits));\n            form.reset();\n        }\n\n    } catch (error) {\n        loader.style.display = 'none';\n        loadButton.style.display = 'none';\n        lightbox.refresh();\n        form.reset();\n        iziToast.error({\n            message:\n                'Oops! Something went wrong... Please, try again!',\n            messageColor: '#fafafb',\n            messageSize: '16px',\n            messageLineHeight: '1.5',\n            backgroundColor: '#ef4040',\n            position: 'topRight',\n        });\n    }\n}\n\nasync function loadNextPage(event) {\n    event.preventDefault();\n    // loader.style.display = 'block';\n    const inputValue = input.value.trim();\n    currentPage++;\n\n    try {\n        const data = await fetchRequest(inputValue, currentPage);\n        const totalPages = Math.ceil(data.totalHits / perPage);\n        gallery.insertAdjacentHTML('beforeend', createGalleryMarkup(data.hits));\n        console.log('all pages' + totalPages);\n        console.log('this page' + currentPage);\n        if (currentPage === totalPages) {\n            loadButton.style.display = 'none';\n            iziToast.info({\n                message:\n                    `We're sorry, but you've reached the end of search results.`,\n                messageColor: '#fafafb',\n                messageSize: '16px',\n                messageLineHeight: '1.5',\n                position: 'topRight',\n            });\n        }\n    } catch (error) {\n        loader.style.display = 'none';\n        loadButton.style.display = 'none';\n        lightbox.refresh();\n        form.reset();\n        iziToast.error({\n            message:\n                'Oops! Something went wrong... Please, try again!',\n            messageColor: '#fafafb',\n            messageSize: '16px',\n            messageLineHeight: '1.5',\n            backgroundColor: '#ef4040',\n            position: 'topRight',\n        });\n    }\n}"],"names":["createGalleryMarkup","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","fetchRequest","name","BASE_URL","API_KEY","params","axios","response","error","form","input","loader","gallery","loadButton","lightbox","SimpleLightbox","perPage","currentPage","handleSubmit","loadNextPage","event","inputValue","iziToast","data","totalPages"],"mappings":"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"}